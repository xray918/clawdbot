# OpenClaw æ²™ç®±èµ„æºç®¡ç†

## ğŸ“Š èµ„æºå ç”¨æ€»ç»“

### åŸºç¡€æ¶ˆè€—ï¼ˆä¸€æ¬¡æ€§ï¼‰

- **Docker é•œåƒ**: 335MB (`openclaw-sandbox:bookworm-slim`)
- **é•œåƒå…±äº«**: æ‰€æœ‰å®¹å™¨å…±äº«æ­¤é•œåƒï¼Œæ— éœ€é‡å¤å ç”¨

### æ¯ç”¨æˆ·å¢é‡æ¶ˆè€—

- **å®¹å™¨å±‚**: 8-20KBï¼ˆDocker å†™æ—¶å¤åˆ¶ï¼‰
- **å·¥ä½œåŒº**: 400KB-2MBï¼ˆä¸´æ—¶æ–‡ä»¶ã€å¯¹è¯å†å²ï¼‰
- **å†…å­˜**: 1-5MBï¼ˆç©ºé—²æ—¶ï¼‰/ 20-100MBï¼ˆæ‰§è¡Œä»»åŠ¡æ—¶ï¼‰
- **CPU**: 0-0.5%ï¼ˆç©ºé—²æ—¶ï¼‰/ æ ¹æ®ä»»åŠ¡åŠ¨æ€å˜åŒ–

## ğŸ”¢ è§„æ¨¡ä¼°ç®—è¡¨

| ç”¨æˆ·è§„æ¨¡  | ç£ç›˜æ€»å ç”¨ | å†…å­˜æ€»å ç”¨ | è¯´æ˜                     |
| --------- | ---------- | ---------- | ------------------------ |
| åŸºç¡€é•œåƒ  | 335MB      | -          | æ‰€æœ‰å®¹å™¨å…±äº«             |
| 10 ç”¨æˆ·   | ~335.5MB   | ~50MB      | å°è§„æ¨¡                   |
| 100 ç”¨æˆ·  | ~340MB     | ~500MB     | ä¸­ç­‰è§„æ¨¡                 |
| 1000 ç”¨æˆ· | ~400MB     | ~5GB       | å¤§è§„æ¨¡ï¼ˆéœ€é…ç½®èµ„æºé™åˆ¶ï¼‰ |

## ğŸ§¹ è‡ªåŠ¨æ¸…ç†ç­–ç•¥

### é»˜è®¤é…ç½®

```json
{
  "agents": {
    "defaults": {
      "sandbox": {
        "prune": {
          "idleHours": 24, // ç©ºé—² 24 å°æ—¶åæ¸…ç†
          "maxAgeDays": 7 // æœ€é•¿ä¿ç•™ 7 å¤©
        }
      }
    }
  }
}
```

### æ¸…ç†è§¦å‘æ¡ä»¶ï¼ˆæ»¡è¶³ä»»ä¸€å³æ¸…ç†ï¼‰

1. âœ… å®¹å™¨ç©ºé—²è¶…è¿‡ 24 å°æ—¶
2. âœ… å®¹å™¨åˆ›å»ºè¶…è¿‡ 7 å¤©

### æ‰‹åŠ¨æ¸…ç†å‘½ä»¤

```bash
# æŸ¥çœ‹æ‰€æœ‰æ²™ç®±å®¹å™¨
docker ps -a --filter "name=openclaw-sbx"

# æ¸…ç†åœæ­¢çš„å®¹å™¨
docker container prune -f

# æ¸…ç†æ‰€æœ‰ OpenClaw æ²™ç®±å®¹å™¨
docker ps -a --filter "name=openclaw-sbx" -q | xargs docker rm -f

# æ¸…ç†æœªä½¿ç”¨çš„é•œåƒ
docker image prune -a -f

# æŸ¥çœ‹ Docker æ•´ä½“å ç”¨
docker system df
```

## âš™ï¸ ä¼˜åŒ–é…ç½®

### 1. æ›´æ¿€è¿›çš„æ¸…ç†ï¼ˆé€‚åˆèµ„æºå—é™ç¯å¢ƒï¼‰

```bash
# ç©ºé—² 1 å°æ—¶åæ¸…ç†
pnpm openclaw config set agents.defaults.sandbox.prune.idleHours 1

# æœ€é•¿ä¿ç•™ 1 å¤©
pnpm openclaw config set agents.defaults.sandbox.prune.maxAgeDays 1
```

### 2. å…±äº«å®¹å™¨æ¨¡å¼ï¼ˆæœ€å°èµ„æºå ç”¨ï¼‰

```bash
# æ‰€æœ‰ç”¨æˆ·å…±äº«ä¸€ä¸ªå®¹å™¨ï¼ˆæ³¨æ„ï¼šæ— ä¼šè¯éš”ç¦»ï¼‰
pnpm openclaw config set agents.defaults.sandbox.scope shared

# èµ„æºå ç”¨ï¼š
# - ç£ç›˜: 335MB (é•œåƒ) + 20KB (å®¹å™¨) = 335MB
# - å†…å­˜: 2-10MB (å•å®¹å™¨)
# âš ï¸  ç¼ºç‚¹ï¼šç”¨æˆ·é—´æ— æ–‡ä»¶éš”ç¦»ï¼Œå®‰å…¨æ€§é™ä½
```

### 3. è®¾ç½®èµ„æºé™åˆ¶ï¼ˆé˜²æ­¢å•ä¸ªå®¹å™¨å ç”¨è¿‡å¤šï¼‰

```bash
# ç¼–è¾‘é…ç½®æ–‡ä»¶
nano ~/.openclaw/openclaw.json

# æ·»åŠ  Docker èµ„æºé™åˆ¶
{
  "agents": {
    "defaults": {
      "sandbox": {
        "docker": {
          "memory": "512m",      // å•å®¹å™¨å†…å­˜é™åˆ¶
          "cpus": "0.5",         // å•å®¹å™¨ CPU é™åˆ¶ï¼ˆ0.5 æ ¸ï¼‰
          "pidsLimit": 100       // è¿›ç¨‹æ•°é™åˆ¶
        }
      }
    }
  }
}
```

### 4. æŒ‰éœ€å¯åŠ¨å®¹å™¨ï¼ˆå»¶è¿Ÿåˆ›å»ºï¼‰

```bash
# å½“å‰é…ç½®ï¼šç”¨æˆ·å‘æ¶ˆæ¯æ—¶æ‰åˆ›å»ºå®¹å™¨
# å®¹å™¨ä¼šåœ¨ç©ºé—²åè‡ªåŠ¨æ¸…ç†ï¼Œä¸‹æ¬¡ä½¿ç”¨æ—¶é‡æ–°åˆ›å»º
# æ— éœ€é¢å¤–é…ç½®ï¼Œé»˜è®¤è¡Œä¸º
```

## ğŸ“ˆ ç›‘æ§å‘½ä»¤

```bash
# å®æ—¶ç›‘æ§æ‰€æœ‰å®¹å™¨èµ„æº
docker stats

# åªç›‘æ§ OpenClaw æ²™ç®±
docker stats $(docker ps -q --filter "name=openclaw-sbx")

# æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯
docker inspect openclaw-sbx-<container-name>

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs openclaw-sbx-<container-name>

# ç»Ÿè®¡å½“å‰è¿è¡Œçš„æ²™ç®±æ•°é‡
docker ps --filter "name=openclaw-sbx" | wc -l
```

## ğŸš€ ç”Ÿäº§ç¯å¢ƒå»ºè®®

### å°è§„æ¨¡ï¼ˆ< 50 ç”¨æˆ·ï¼‰

```json
{
  "sandbox": {
    "mode": "all",
    "scope": "session", // æ¯ç”¨æˆ·ç‹¬ç«‹å®¹å™¨
    "prune": {
      "idleHours": 24,
      "maxAgeDays": 7
    }
  }
}
```

- **é¢„æœŸå ç”¨**: ~340MB ç£ç›˜ + 500MB å†…å­˜
- **ä¼˜ç‚¹**: å®Œå…¨éš”ç¦»ï¼Œæ— éœ€ä¼˜åŒ–

### ä¸­ç­‰è§„æ¨¡ï¼ˆ50-500 ç”¨æˆ·ï¼‰

```json
{
  "sandbox": {
    "mode": "all",
    "scope": "session",
    "docker": {
      "memory": "256m", // é™åˆ¶å•å®¹å™¨å†…å­˜
      "cpus": "0.5"
    },
    "prune": {
      "idleHours": 12, // æ›´å¿«æ¸…ç†
      "maxAgeDays": 3
    }
  }
}
```

- **é¢„æœŸå ç”¨**: ~360MB ç£ç›˜ + 2-5GB å†…å­˜
- **ä¼˜ç‚¹**: èµ„æºå¯æ§ï¼Œéš”ç¦»æ€§å¥½

### å¤§è§„æ¨¡ï¼ˆ> 500 ç”¨æˆ·ï¼‰

```json
{
  "sandbox": {
    "mode": "all",
    "scope": "agent", // æŒ‰ agent å…±äº«å®¹å™¨
    "docker": {
      "memory": "1g",
      "cpus": "1.0"
    },
    "prune": {
      "idleHours": 6,
      "maxAgeDays": 1
    }
  }
}
```

- **é¢„æœŸå ç”¨**: ~400MB ç£ç›˜ + 5-10GB å†…å­˜
- **è€ƒè™‘**: Kubernetes + è´Ÿè½½å‡è¡¡

## ğŸ” å®é™…æµ‹è¯•æ•°æ®ï¼ˆä½ çš„ç¯å¢ƒï¼‰

```bash
# åŸºç¡€é•œåƒ
openclaw-sandbox:bookworm-slim: 335MB

# è¿è¡Œä¸­å®¹å™¨
openclaw-sbx-agent-main-main-20ceb99b:
  - å®¹å™¨å±‚: 8.19KB
  - è™šæ‹Ÿå¤§å°: 259MB (å…±äº«é•œåƒ)
  - å†…å­˜: 1.258MB
  - CPU: 0.00%
  - å·¥ä½œåŒº: 432KB

# Docker ç³»ç»Ÿå ç”¨
Images: 9.4GB (11 ä¸ªé•œåƒ)
Containers: 1.7MB (7 ä¸ªå®¹å™¨)
Volumes: 2GB (15 ä¸ªå·)
```

## â“ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆè™šæ‹Ÿå¤§å° 259MBï¼Œä½†å®é™…åªå ç”¨ 8KBï¼Ÿ

A: Docker ä½¿ç”¨åˆ†å±‚æ–‡ä»¶ç³»ç»Ÿã€‚åŸºç¡€é•œåƒï¼ˆ335MBï¼‰è¢«æ‰€æœ‰å®¹å™¨å…±äº«ï¼Œæ¯ä¸ªå®¹å™¨åªå­˜å‚¨è‡ªå·±çš„ä¿®æ”¹ï¼ˆå†™æ—¶å¤åˆ¶ï¼‰ï¼Œæ‰€ä»¥å®é™…å ç”¨æå°ã€‚

### Q: å®¹å™¨ä¼šä¸€ç›´è¿è¡Œå—ï¼Ÿ

A: ä¸ä¼šã€‚ç©ºé—² 24 å°æ—¶ï¼ˆå¯é…ç½®ï¼‰åè‡ªåŠ¨æ¸…ç†ã€‚ç”¨æˆ·ä¸‹æ¬¡ä½¿ç”¨æ—¶é‡æ–°åˆ›å»ºã€‚

### Q: å¦‚ä½•æŸ¥çœ‹æœ‰å¤šå°‘å®¹å™¨åœ¨è¿è¡Œï¼Ÿ

A: `docker ps --filter "name=openclaw-sbx" | wc -l`

### Q: å¦‚ä½•å¼ºåˆ¶æ¸…ç†æ‰€æœ‰æ²™ç®±ï¼Ÿ

A: `docker ps -a --filter "name=openclaw-sbx" -q | xargs docker rm -f`

### Q: å†…å­˜ä¸å¤Ÿæ€ä¹ˆåŠï¼Ÿ

A: 1) å‡å°‘ `idleHours`ï¼Œ2) è®¾ç½® `docker.memory` é™åˆ¶ï¼Œ3) è€ƒè™‘ `scope: "shared"`

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Sandboxing å®Œæ•´æ–‡æ¡£](./docs/gateway/sandboxing.md)
- [Docker é…ç½®](./docs/install/docker.md)
- [å¤š Agent é…ç½®](./docs/concepts/multi-agent.md)
